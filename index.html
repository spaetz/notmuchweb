<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Welcome to notmuch’s documentation! &mdash; notmuch v0.1 documentation</title>
    <link rel="stylesheet" href="static/default.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.1',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <link rel="top" title="notmuch v0.1 documentation" href="" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="">notmuch v0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="welcome-to-notmuch-s-documentation">
<h1>Welcome to notmuch&#8217;s documentation!<a class="headerlink" href="#welcome-to-notmuch-s-documentation" title="Permalink to this headline">¶</a></h1>
<p>The <tt class="xref docutils literal"><span class="pre">notmuch</span></tt> module provides an interface to the <a class="reference external" href="http://notmuchmail.org">notmuch</a> functionality. The main work horse of this module is the class <a title="notmuchweb.notmuch.Notmuch" class="reference internal" href="#notmuchweb.notmuch.Notmuch"><tt class="xref docutils literal"><span class="pre">Notmuch</span></tt></a> with important other classes representing a <a title="notmuchweb.notmuch.Thread" class="reference internal" href="#notmuchweb.notmuch.Thread"><tt class="xref docutils literal"><span class="pre">Thread</span></tt></a> and a single <a title="notmuchweb.notmuch.Message" class="reference internal" href="#notmuchweb.notmuch.Message"><tt class="xref docutils literal"><span class="pre">Message</span></tt></a>.</p>
<blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The current code assumes that  you have the dateparser branch applied. It also assumes that the patch is included to send the notmuch tags as json arrays. If the latter has not, I have been experiencing weird json parsing failures.</p>
</div>
</blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">License:</th><td class="field-body">This module is covered under the GNU GPL v2 (or later).</td>
</tr>
</tbody>
</table>
<p>This page contains the main API overview. More information on specific topics can be found on the following pages:</p>
<ul class="simple">
</ul>
</div>
<div class="section" id="notmuch-the-notmuch-interface">
<h1><tt class="xref docutils literal"><span class="pre">notmuch</span></tt> &#8211; The Notmuch interface<a class="headerlink" href="#notmuch-the-notmuch-interface" title="Permalink to this headline">¶</a></h1>
<div class="section" id="message-a-single-email-message">
<h2><a title="notmuchweb.notmuch.Message" class="reference internal" href="#notmuchweb.notmuch.Message"><tt class="xref docutils literal"><span class="pre">Message</span></tt></a> &#8211; A single email message<a class="headerlink" href="#message-a-single-email-message" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="notmuchweb.notmuch.Message">
<em class="property">
class </em><tt class="descname">Message</tt><big>(</big><em>nm_msg</em><big>)</big><a class="headerlink" href="#notmuchweb.notmuch.Message" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents a message as returned by notmuch.</p>
<ul>
<li><p class="first">Valid instance variables self.*</p>
<blockquote>
<p>The following vars are set on the initial parsing 
(or dynamically created as properties):
.id (msg id, is set on the initial parsing)
.file (full file name including path, is set on the initial parsing)
.maildirflags: a set() of MailDir flags
.tags: a set() of notmuch tags
and many more properties. Please refer to the class documentation
for details.</p>
</blockquote>
<p>If the following two variables contain a set() of tags/flags that are 
different from .tags .notmuchtags, a sync_msg_tags will write those 
changes:
.sync_maildirflags: a set() of MailDir flags to be used
.sync_tags: a set() of notmuch tags to be used</p>
<p>.is_valid: is True if parsing found a message, False otherwise</p>
</li>
</ul>
<dl class="method">
<dt id="notmuchweb.notmuch.Message.sync_msg_tags">
<tt class="descname">sync_msg_tags</tt><big>(</big><em>dryrun=False</em><big>)</big><a class="headerlink" href="#notmuchweb.notmuch.Message.sync_msg_tags" title="Permalink to this definition">¶</a></dt>
<dd>Sync up changed maildir tags and/or notmuch tags.
It examines self.tags|sync_tags and self.maildirflags|sync_maildirflags
sync_* contains the new set of tags to be applied</dd></dl>

</dd></dl>

</div>
<div class="section" id="thread-represents-a-message-thread">
<h2><a title="notmuchweb.notmuch.Thread" class="reference internal" href="#notmuchweb.notmuch.Thread"><tt class="xref docutils literal"><span class="pre">Thread</span></tt></a> &#8211; Represents a message thread<a class="headerlink" href="#thread-represents-a-message-thread" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="notmuchweb.notmuch.Thread">
<em class="property">
class </em><tt class="descname">Thread</tt><big>(</big><em>json_thread=None</em>, <em>keep_body=True</em>, <em>keep_nonmatch=True</em>, <em>depth=0</em><big>)</big><a class="headerlink" href="#notmuchweb.notmuch.Thread" title="Permalink to this definition">¶</a></dt>
<dd><p>An iterator containing a bunch of mail messages retaining the thread structure).</p>
<p>The work horse is self.msgs which is a list of (depth, Message()) tuples.
depth starts at 0 and increases for replies.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A Thread is what a call to notmuch.show() will return, containing a bunch of <a title="notmuchweb.notmuch.Message" class="reference internal" href="#notmuchweb.notmuch.Message"><tt class="xref docutils literal"><span class="pre">Message</span></tt></a>s.</p>
</div>
<dl class="method">
<dt id="notmuchweb.notmuch.Thread.next">
<tt class="descname">next</tt><big>(</big><big>)</big><a class="headerlink" href="#notmuchweb.notmuch.Thread.next" title="Permalink to this definition">¶</a></dt>
<dd>returns the next message when iterating</dd></dl>

<dl class="method">
<dt id="notmuchweb.notmuch.Thread.parse_forest">
<tt class="descname">parse_forest</tt><big>(</big><em>json_threads</em><big>)</big><a class="headerlink" href="#notmuchweb.notmuch.Thread.parse_forest" title="Permalink to this definition">¶</a></dt>
<dd><p>parses and add multiple &#8216;threads&#8217; (json object)</p>
<p>The method honors existing self.keep_body and self.keep_nonmatch values
returns: self</p>
</dd></dl>

<dl class="method">
<dt id="notmuchweb.notmuch.Thread.parse_thread">
<tt class="descname">parse_thread</tt><big>(</big><em>json_thread</em>, <em>keep_body</em><big>)</big><a class="headerlink" href="#notmuchweb.notmuch.Thread.parse_thread" title="Permalink to this definition">¶</a></dt>
<dd>parses a json_thread object and adds (depth, Message()) tuples to
self.msg</dd></dl>

</dd></dl>

</div>
<div class="section" id="notmuch-a-notmuch-call">
<h2><a title="notmuchweb.notmuch.Notmuch" class="reference internal" href="#notmuchweb.notmuch.Notmuch"><tt class="xref docutils literal"><span class="pre">Notmuch</span></tt></a> &#8211; A notmuch call<a class="headerlink" href="#notmuch-a-notmuch-call" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="notmuchweb.notmuch.Notmuch">
<em class="property">
class </em><tt class="descname">Notmuch</tt><big>(</big><em>logger=None</em><big>)</big><a class="headerlink" href="#notmuchweb.notmuch.Notmuch" title="Permalink to this definition">¶</a></dt>
<dd><p>python abstraction to the notmuch command line interface.</p>
<p>Notmuch represents a specific request. Calling its method will cause the actual notmuch calls.
It uses the logging module for logging, so you can set that up to log 
to files etc.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameter:</th><td class="field-body"><em>logger</em> (logging.Logger) &#8211; A logging.Logger to be used for logging</td>
</tr>
<tr class="field"><th class="field-name">Return type:</th><td class="field-body">the initialized Notmuch instance</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="notmuchweb.notmuch.Notmuch.exec_cmd">
<tt class="descname">exec_cmd</tt><big>(</big><em>cmdoptions</em><big>)</big><a class="headerlink" href="#notmuchweb.notmuch.Notmuch.exec_cmd" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute a notmuch command and return the &#8216;process&#8217;</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameter:</th><td class="field-body"><em>cmdoptions</em> &#8211; is a list of command options to notmuch. You will</td>
</tr>
</tbody>
</table>
<p>usually finish the prosess with something like:
(stdout, stderr) = process.communicate()
:type cmdoptions: [strings]</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Return type:</th><td class="field-body">process as returned by subprocess.Popen</td>
</tr>
<tr class="field"><th class="field-name">Exception:</th><td class="field-body"><em>:exc:`OSError`: [Errno 2] No such file or directory</em> if notmuch is not installed or in the searchable path</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="notmuchweb.notmuch.Notmuch.new">
<tt class="descname">new</tt><big>(</big><big>)</big><a class="headerlink" href="#notmuchweb.notmuch.Notmuch.new" title="Permalink to this definition">¶</a></dt>
<dd>Perform a notmuch new in order to get a consistent db
Returns: True on success or None on error</dd></dl>

<dl class="method">
<dt id="notmuchweb.notmuch.Notmuch.prune">
<tt class="descname">prune</tt><big>(</big><em>criteria='tag:delete or tag:maildir::trashed'</em>, <em>dryrun=False</em><big>)</big><a class="headerlink" href="#notmuchweb.notmuch.Notmuch.prune" title="Permalink to this definition">¶</a></dt>
<dd>Physically delete all mail files matching &#8216;tag&#8217;. 
Returns the number of matched mails.
If dryrun == True, it will not actually delete them.</dd></dl>

<dl class="method">
<dt id="notmuchweb.notmuch.Notmuch.show">
<tt class="descname">show</tt><big>(</big><em>term</em>, <em>wholeThread=False</em><big>)</big><a class="headerlink" href="#notmuchweb.notmuch.Notmuch.show" title="Permalink to this definition">¶</a></dt>
<dd><p>searches notmuch for &#8220;term&#8221;
returns a Thread() object containing all messages,</p>
<p>Returns even on an xapian error,
as not all of them are fatal and some occur frequently...</p>
</dd></dl>

<dl class="method">
<dt id="notmuchweb.notmuch.Notmuch.syncTags">
<tt class="descname">syncTags</tt><big>(</big><em>thorough=False</em>, <em>frommaildir=False</em>, <em>dryrun=False</em>, <em>all_mails=None</em><big>)</big><a class="headerlink" href="#notmuchweb.notmuch.Notmuch.syncTags" title="Permalink to this definition">¶</a></dt>
<dd><p>sync the unread Tags. It does not really go through all mail files,
but compares the stored file name with the notmuch tags.
It will take the maildir tags as authoritative if &#8216;frommaildir&#8217; or 
the notmuch tags otherwise.</p>
<p>This code requires that the dateparser branch has been applied to notmuch as it will not understand the used timestamps otherwise.(TODO, should implement a fallback, as that is not going to to be incorporated anytime soon)
Flags handled:
* &#8220;S&#8221;: the user has viewed this message. Corresponds to &#8220;unread&#8221; tag
* &#8220;T&#8221; (deleted): the user has moved this message to the trash.
* &#8220;D&#8221; (draft):
* &#8220;F&#8221; (flagged): user-defined flag; toggled at user discretion. 
Not handled:
* Flag &#8220;P&#8221; (passed): the user has resent/forwarded/bounced this message.
* Flag &#8220;R&#8221; (replied): the user has replied to this message.</p>
</dd></dl>

<dl class="method">
<dt id="notmuchweb.notmuch.Notmuch.unlink_file">
<tt class="descname">unlink_file</tt><big>(</big><em>m</em><big>)</big><a class="headerlink" href="#notmuchweb.notmuch.Notmuch.unlink_file" title="Permalink to this definition">¶</a></dt>
<dd>returns 1 on success, or 0 otherwise.
Does not fail if the file does not exist.</dd></dl>

</dd></dl>

</div>
<div class="section" id="notmucherror-a-notmuch-execution-error">
<h2><tt class="xref docutils literal"><span class="pre">NotmuchError</span></tt> &#8211; A Notmuch execution error<a class="headerlink" href="#notmucherror-a-notmuch-execution-error" title="Permalink to this headline">¶</a></h2>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference external" href="genindex.html"><em>Index</em></a></li>
<li><a class="reference external" href="search.html"><em>Search Page</em></a></li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="">Welcome to notmuch&#8217;s documentation!</a><ul>
</ul>
</li>
<li><a class="reference external" href="#notmuch-the-notmuch-interface"><tt class="docutils literal"><span class="pre">notmuch</span></tt> &#8211; The Notmuch interface</a><ul>
<li><a class="reference external" href="#message-a-single-email-message"><tt class="docutils literal"><span class="pre">Message</span></tt> &#8211; A single email message</a></li>
<li><a class="reference external" href="#thread-represents-a-message-thread"><tt class="docutils literal"><span class="pre">Thread</span></tt> &#8211; Represents a message thread</a></li>
<li><a class="reference external" href="#notmuch-a-notmuch-call"><tt class="docutils literal"><span class="pre">Notmuch</span></tt> &#8211; A notmuch call</a></li>
<li><a class="reference external" href="#notmucherror-a-notmuch-execution-error"><tt class="docutils literal"><span class="pre">NotmuchError</span></tt> &#8211; A Notmuch execution error</a></li>
</ul>
</li>
<li><a class="reference external" href="#indices-and-tables">Indices and tables</a></li>
</ul>

            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="sources/index.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li><a href="">notmuch v0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2010, Sebastian Spaeth.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.2.
    </div>
  </body>
</html>